name: Simple Stats
on:
  schedule: [{cron: "0 * * * *"}] # Run every hour
  workflow_dispatch:
  push: {branches: ["master", "main"]}

jobs:
  generate-analytics:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      # ----------------------------------------------------------------
      # 1. STREAK CARD (Official DenverCoder1 Action)
      # ----------------------------------------------------------------
      - name: Generate Streak
        uses: DenverCoder1/github-readme-streak-stats@v2
        with:
          github_user: civilisedfalcon
          output_path: streak.svg
          mode: daily
          theme: gruvbox
          hide_border: true
          border_radius: 0
        env:
          GITHUB_TOKEN: ${{ secrets.METRICS_TOKEN }}

      # ----------------------------------------------------------------
      # 2. STATS & LANGUAGES (Profile Summary Cards Action)
      # ----------------------------------------------------------------
      - name: Generate Stats & Langs
        uses: vn7n24fzkq/github-profile-summary-cards@release
        env:
          GITHUB_TOKEN: ${{ secrets.METRICS_TOKEN }}
        with:
          USERNAME: civilisedfalcon
          # This generates a whole folder of cards in your repo
          # You can pick the ones you want to display

      # ----------------------------------------------------------------
      # 3. PUSH CHANGES
      # ----------------------------------------------------------------
      # Note: The vn7n24fzkq action commits automatically, 
      # but we add this just in case for the Streak card.
      - name: Push Streak Image
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "Update streak stats"
          file_pattern: "streak.svg"
